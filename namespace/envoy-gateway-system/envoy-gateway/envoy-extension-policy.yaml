apiVersion: gateway.envoyproxy.io/v1alpha1
kind: EnvoyExtensionPolicy
metadata:
  name: authentik-policy
  namespace: envoy-gateway-system
spec:
  targetRef:
    group: gateway.networking.k8s.io
    kind: HTTPRoute
    name: "*"
    namespace: "*"
    selectorType: Selector
    selector:
      matchLabels:
        auth.envoy.io/enabled: "true"
  extensionRef:
    group: gateway.envoyproxy.io
    kind: EnvoyExtension
    name: authentik-auth
    namespace: envoy-gateway-system